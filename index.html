<!doctype html> <html lang="es" data-theme="dark"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <style> :root{ --fg:#e8eef6; --card:#161a2b; --line:#2b2f40; --muted:#a9b3c3; --op1:#7aa8ff; --op2:#22c3a6; --op3:#ff8ab3; --op4:#c466ff; --ex:#c3b5ff; --radius:14px; --gap:1rem; --pad:1rem; } *{box-sizing:border-box} html,body{margin:0;padding:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0e1324,#0b1720,#151a2e);color:var(--fg);min-height:100%} body{display:flex;align-items:center;justify-content:center} .wrap{width:100%;max-width:1200px;margin:auto;padding:2rem 1rem} header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem} h1{margin:0;font-size:1.8rem} .controls{display:flex;gap:.5rem} .toggle{padding:.5rem 1rem;border:1px solid var(--line);background:var(--card);color:var(--fg);border-radius:999px;font-weight:700;cursor:pointer} .layout{display:grid;grid-template-columns:1fr .8fr;gap:var(--gap)} @media (max-width:900px){.layout{grid-template-columns:1fr}} .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:var(--pad)} /* FIXED: valid flex declaration */ aside.card{display:flex; flex-direction:column} .title{font-size:1.2rem;font-weight:800;margin:0 0 1rem} .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--gap)} .opt{background:rgba(255,255,255,.02);border:2px solid var(--line);border-radius:var(--radius);padding:1rem;transition:transform .15s ease,background .15s ease} .opt:hover{background:rgba(255,255,255,.05);transform:scale(1.02)} .top{display:flex;align-items:center;gap:.8rem;margin-bottom:.5rem} .btn50{width:44px;height:35px;border:none;border-radius:8px;font-weight:900;color:#111} .op1{background:var(--op1)} .op2{background:var(--op2)} .op3{background:var(--op3)} .op4{background:var(--op4)} .desc{color:var(--muted);font-size:.95rem} .actions{display:flex;gap:.5rem;margin-top:.6rem} .btn{padding:6px 12px;border:1px solid var(--line);background:transparent;color:var(--fg);font-weight:800;border-radius:10px;cursor:pointer;font-size:13px;white-space:nowrap;transition:background .15s ease,color .15s ease,border-color .15s ease} .btn-adding{background:#22c3a6 !important;color:#0b0f18 !important;border-color:#22c3a6 !important} /* FIXED: valid flex declaration */ .ex-list{display:flex; flex-direction:column; gap:.75rem} .ex-row{display:grid;grid-template-columns:1fr auto;align-items:center;background:rgba(255,255,255,.03);border:1px solid var(--line);border-radius:12px;padding:.75rem 1rem} .ex-left{display:flex;align-items:center;gap:1rem;font-weight:800} .ex-price{font-size:.9rem;padding:.35rem .7rem;border-radius:8px;border:1px dashed var(--line);background:rgba(255,255,255,.05);font-weight:800} .cart{border:1px dashed var(--line);border-radius:var(--radius);padding:1rem;max-height:320px;overflow:auto} .line{display:grid;grid-template-columns:1fr auto auto;gap:.6rem;align-items:center;padding:.6rem 0;border-bottom:1px dotted rgba(255,255,255,.06)} .qtybox{display:flex;align-items:center;gap:.5rem} .totals{margin-top:1rem;display:grid;gap:.5rem} .totals .row{display:flex;justify-content:space-between} .grand{font-size:1.6rem;font-weight:900} .accept-btn{margin-top:1.2rem;padding:1rem 2rem;font-size:1.2rem;background:var(--op2);color:#0b0f18;border:none;border-radius:12px;cursor:pointer;align-self:flex-end;box-shadow:0 6px 18px rgba(0,0,0,.22);transition:transform .06s ease,background .2s ease} .accept-btn:active{transform:translateY(1px)} .accept-btn:hover{background:#1aa58a} .toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%);background:#22c3a6;color:#0b0f18;padding:.75rem 1.1rem;border-radius:12px;font-weight:900;box-shadow:0 10px 26px rgba(0,0,0,.25);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:10000} .toast.show{opacity:1} .loader-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:9999} .loader{width:54px;height:54px;border:6px solid rgba(255,255,255,.25);border-top-color:#22c3a6;border-radius:50%;animation:spin .9s linear infinite} @keyframes spin{to{transform:rotate(360deg)}} [data-theme="light"] body{background:linear-gradient(135deg,#f3fbf7,#eaf2ff,#ffe9ef)} [data-theme="light"] .btn-adding{background:#22c3a6 !important;color:#0b0f18 !important} </style> </head> <body> <div class="wrap"> <header> <h1>Orden Rápida</h1> <div class="controls"> <button id="lang" class="toggle" aria-label="EN/ES">ES</button> <button id="theme" class="toggle" aria-label="Light/Dark">Dark</button> </div> </header>
<div class="layout">
  <section class="card">
    <h2 class="title">Opciones</h2>
    <div id="opts" class="grid"></div>

    <div class="card" style="margin-top:14px">
      <h2 class="title">Extras</h2>
      <div id="extras" class="ex-list"></div>
    </div>
  </section>

  <aside class="card">
    <h2 class="title">Resumen</h2>
    <div id="cart" class="cart" aria-live="polite" aria-atomic="true"></div>

    <div class="totals" aria-live="polite" aria-atomic="true">
      <div class="row"><div>Subtotal</div><div id="subtotal">—</div></div>
      <div class="row"><div>IVA (15%)</div><div id="vat">—</div></div>
      <div class="row"><div class="grand">TOTAL</div><div id="total" class="grand">—</div></div>
    </div>

    <button id="accept" class="accept-btn">Aceptar</button>
  </aside>
</div>

</div> <div id="loader" class="loader-overlay"><div class="loader"></div></div> <div id="toast" class="toast">¡Pedido enviado con éxito!</div> <script> // ====== Config ====== const IVA_RATE = 0.15; // 15% const LOCALE = { es: 'es-EC', en: 'en-US' }; // UI locale only const USD_FMT = { style:'currency', currency:'USD' }; // Force USD in UI let currentLang = 'es'; // ====== Catalog ====== const OPTIONS = [ { id:'op1', name:{es:'Opción 1',en:'Option 1'}, desc:{es:'Tortilla + Huevos + Chorizo + Bebida', en:'Tortilla + Eggs + Sausage + Drink'}, priceCents:320 }, { id:'op2', name:{es:'Opción 2',en:'Option 2'}, desc:{es:'Tortilla + Chorizo + Bebida', en:'Tortilla + Sausage + Drink'}, priceCents:270 }, { id:'op3', name:{es:'Opción 3',en:'Option 3'}, desc:{es:'Tortilla + Huevos + Bebida', en:'Tortilla + Eggs + Drink'}, priceCents:270 }, { id:'op4', name:{es:'Opción 4',en:'Option 4'}, desc:{es:'2 Tortilla + 2 Huevos + 2 Chorizo + 2 Bebida', en:'2 Tortillas + 2 Eggs + 2 Sausages + 2 Drinks'}, priceCents:640 } ]; const EXTRAS = [ { id:'ex_cafe', name:{es:'Café',en:'Coffee'}, priceCents:70 }, { id:'ex_cola', name:{es:'Cola',en:'Cola'}, priceCents:70 }, { id:'ex_chorizo', name:{es:'Chorizo',en:'Sausage'}, priceCents:70 }, { id:'ex_huevo', name:{es:'Huevo',en:'Egg'}, priceCents:70 }, { id:'ex_tortilla', name:{es:'Tortilla',en:'Tortilla'}, priceCents:70 } ]; // ====== State & Helpers ====== const cart = new Map(); const $ = s => document.querySelector(s); const t = v => typeof v === 'string' ? v : v[currentLang]; const money = c => (c/100).toLocaleString('en-US', USD_FMT); // Always show USD function two(n){ return String(n).padStart(2,'0'); } function fmtDateMMDDYYYY(d){ return `${two(d.getMonth()+1)}/${two(d.getDate())}/${d.getFullYear()}`; } // MM/DD/YYYY function fmtTime24(d){ return `${two(d.getHours())}:${two(d.getMinutes())}`; } // HH:mm function add(item){ const line = cart.get(item.id) || { ...item, qty:0 }; line.qty++; cart.set(item.id, line); const isDark = (document.documentElement.getAttribute('data-theme') || 'dark') === 'dark'; if(isDark){ const btn = document.querySelector(`button[data-act="add"][data-id="${item.id}"]`); if(btn){ btn.classList.add('btn-adding'); setTimeout(()=>btn.classList.remove('btn-adding'), 2000); } } render(); } function rem(item){ if(!cart.has(item.id)) return; const line = cart.get(item.id); line.qty--; if(line.qty<=0) cart.delete(item.id); else cart.set(item.id, line); render(); } function buildOptions(){ const host = $('#opts'); host.innerHTML=''; OPTIONS.forEach((o,i)=>{ const el = document.createElement('div'); el.className='opt'; el.innerHTML = ` <div class="top"> <button class="btn50 op${(i%4)+1}">${i+1}</button> <div> <div class="desc">${t(o.desc)} — <strong>${money(o.priceCents)}</strong></div> <div class="actions"> <button class="btn" data-act="rem" data-id="${o.id}">− Quitar</button> <button class="btn" data-act="add" data-id="${o.id}">+ Agregar</button> </div> </div> </div>`; host.appendChild(el); }); } function buildExtras(){ const host = $('#extras'); host.innerHTML=''; EXTRAS.forEach(e=>{ const row = document.createElement('div'); row.className='ex-row'; row.innerHTML = ` <div class="ex-left">${t(e.name)} <span class="ex-price">${money(e.priceCents)}</span></div> <div class="actions"> <button class="btn" data-act="rem" data-id="${e.id}">−</button> <button class="btn" data-act="add" data-id="${e.id}">+ Agregar</button> </div>`; host.appendChild(row); }); } function render(){ const box = $('#cart'); box.innerHTML=''; let subtotal = 0; cart.forEach(line=>{ subtotal += line.priceCents * line.qty; const el = document.createElement('div'); el.className='line'; el.innerHTML = ` <div>${line.name}</div> <div class="qtybox"> <button class="btn" data-act="rem" data-id="${line.id}">−</button> <span>${line.qty}</span> <button class="btn" data-act="add" data-id="${line.id}">+</button> </div> <div><strong>${money(line.priceCents*line.qty)}</strong></div>`; box.appendChild(el); }); const vat = Math.round(subtotal * IVA_RATE); const total = subtotal + vat; $('#subtotal').textContent = money(subtotal); $('#vat').textContent = money(vat); $('#total').textContent = money(total); } // ====== UI toggles ====== $('#lang').addEventListener('click', ()=>{ currentLang = currentLang==='es' ? 'en' : 'es'; $('#lang').textContent = currentLang.toUpperCase(); buildOptions(); buildExtras(); render(); }); $('#theme').addEventListener('click', ()=>{ const root = document.documentElement; const cur = root.getAttribute('data-theme') || 'dark'; const next = cur==='dark' ? 'light' : 'dark'; root.setAttribute('data-theme', next); $('#theme').textContent = next==='light' ? 'Light' : 'Dark'; }); // ====== Click handling ====== document.body.addEventListener('click', (e)=>{ const btn = e.target.closest('button[data-act]'); if(!btn) return; const id = btn.getAttribute('data-id'); const act = btn.getAttribute('data-act'); const item = OPTIONS.find(x=>x.id===id) || EXTRAS.find(x=>x.id===id) || cart.get(id); if(!item) return; const payload = { id:item.id, name:(item.name?.[currentLang] ?? item.name), priceCents:item.priceCents }; act==='add' ? add(payload) : rem(payload); }); // ====== Submit to Apps Script with requested fields ====== const ENDPOINT = 'https://script.google.com/macros/s/AKfycbyXrbBry5Cmn0RqvDl2lGfhRWBueYvhBSjTk_E83HchPRuacNxa-_DBBjpW8wjjfGMtxw/exec'; const loader = $('#loader'); const toast = $('#toast'); function showToast(msg, ms=1800){ const now = new Date(); const stamp = `${fmtDateMMDDYYYY(now)} ${fmtTime24(now)}`; // MM/DD/YYYY HH:mm toast.textContent = `${msg} — ${stamp}`; toast.classList.add('show'); setTimeout(() => toast.classList.remove('show'), ms); } $('#accept').addEventListener('click', async () => { if (cart.size === 0) { showToast('Carrito vacío'); return; } const now = new Date(); const rows = []; cart.forEach(item => { const unit = item.priceCents; // unit price (cents) const lineSubtotal = item.qty * unit; // without VAT (cents) const lineVAT = Math.round(lineSubtotal * IVA_RATE); const lineTotal = lineSubtotal + lineVAT; rows.push({ date: fmtDateMMDDYYYY(now), // MM/DD/YYYY time: fmtTime24(now), // HH:mm (24h) opcion: item.name, // text (current language) cantidad: item.qty, // number precio: (unit/100).toFixed(2), // USD iva: (lineVAT/100).toFixed(2), // USD total: (lineTotal/100).toFixed(2) // USD }); }); loader.style.display = 'flex'; try { const res = await fetch(ENDPOINT, { method: 'POST', body: JSON.stringify(rows), headers: { 'Content-Type': 'text/plain' }, mode: 'cors' }); const text = await res.text(); loader.style.display = 'none'; if (res.ok && text.includes('Success')) { showToast('¡Pedido enviado con éxito!'); cart.clear(); render(); } else { showToast(`Error al enviar: ${text || 'Sin respuesta del servidor'}`); console.error('Server response:', text); } } catch (err) { loader.style.display = 'none'; showToast(`No se pudo conectar: ${err.message}`); console.error('Fetch error:', err); } }); // ====== Init ====== (function init(){ document.documentElement.setAttribute('data-theme', 'dark'); buildOptions(); buildExtras(); render(); })(); </script> </body> </html>
